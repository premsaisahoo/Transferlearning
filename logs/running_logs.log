[2022-05-19 17:52:38,499: INFO: 02_transfer_learning_even_odd]: 
********************
[2022-05-19 17:52:38,500: INFO: 02_transfer_learning_even_odd]: >>>>> stage transfer learning started <<<<<
[2022-05-19 17:52:38,503: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-05-19 17:52:39,556: INFO: 02_transfer_learning_even_odd]: transferlearning model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inputlayer1 (Flatten)       (None, 784)               0         
                                                                 
 hiddenlayer2 (Dense)        (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 hiddenlayer3 (Dense)        (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-05-19 17:52:39,596: INFO: 02_transfer_learning_even_odd]: transferlearning model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inputlayer1 (Flatten)       (None, 784)               0         
                                                                 
 hiddenlayer2 (Dense)        (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 hiddenlayer3 (Dense)        (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________

[2022-05-19 17:54:15,646: INFO: common]: created directory at: artifacts\models
[2022-05-19 17:54:15,690: INFO: 02_transfer_learning_even_odd]: base model is saved at artifacts\models\even_odd_model.h5
[2022-05-19 17:54:17,073: ERROR: 02_transfer_learning_even_odd]: Graph execution error:

Detected at node 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits' defined at (most recent call last):
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
      main(config_path=parsed_args.config)
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
      logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test)}")
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1716, in evaluate
      tmp_logs = self.test_function(iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1525, in test_function
      return step_function(self, iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1514, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1507, in run_step
      outputs = model.test_step(data)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1473, in test_step
      self.compute_loss(x, y, y_pred, sample_weight)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 918, in compute_loss
      return self.compiled_loss(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\compile_utils.py", line 201, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 141, in __call__
      losses = call_fn(y_true, y_pred)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 245, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 1862, in sparse_categorical_crossentropy
      return backend.sparse_categorical_crossentropy(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\backend.py", line 5202, in sparse_categorical_crossentropy
      res = tf.nn.sparse_softmax_cross_entropy_with_logits(
Node: 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits'
Received a label value of 9 which is outside the valid range of [0, 2).  Label values: 7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1
	 [[{{node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits}}]] [Op:__inference_test_function_226533]
Traceback (most recent call last):
  File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
    main(config_path=parsed_args.config)
  File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
    logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test)}")
  File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\Admin\anaconda3\lib\site-packages\tensorflow\python\eager\execute.py", line 54, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits' defined at (most recent call last):
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
      main(config_path=parsed_args.config)
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
      logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test)}")
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1716, in evaluate
      tmp_logs = self.test_function(iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1525, in test_function
      return step_function(self, iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1514, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1507, in run_step
      outputs = model.test_step(data)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1473, in test_step
      self.compute_loss(x, y, y_pred, sample_weight)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 918, in compute_loss
      return self.compiled_loss(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\compile_utils.py", line 201, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 141, in __call__
      losses = call_fn(y_true, y_pred)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 245, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 1862, in sparse_categorical_crossentropy
      return backend.sparse_categorical_crossentropy(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\backend.py", line 5202, in sparse_categorical_crossentropy
      res = tf.nn.sparse_softmax_cross_entropy_with_logits(
Node: 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits'
Received a label value of 9 which is outside the valid range of [0, 2).  Label values: 7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1
	 [[{{node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits}}]] [Op:__inference_test_function_226533]
[2022-05-19 17:57:02,629: INFO: 02_transfer_learning_even_odd]: 
********************
[2022-05-19 17:57:02,629: INFO: 02_transfer_learning_even_odd]: >>>>> stage transfer learning started <<<<<
[2022-05-19 17:57:02,630: INFO: common]: yaml file: configs/config.yaml loaded successfully
[2022-05-19 17:57:03,315: INFO: 02_transfer_learning_even_odd]: transferlearning model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inputlayer1 (Flatten)       (None, 784)               0         
                                                                 
 hiddenlayer2 (Dense)        (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 hiddenlayer3 (Dense)        (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 10)                1010      
                                                                 
=================================================================
Total params: 266,610
Trainable params: 266,610
Non-trainable params: 0
_________________________________________________________________

[2022-05-19 17:57:03,368: INFO: 02_transfer_learning_even_odd]: transferlearning model summary: 
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 inputlayer1 (Flatten)       (None, 784)               0         
                                                                 
 hiddenlayer2 (Dense)        (None, 300)               235500    
                                                                 
 leaky_re_lu (LeakyReLU)     (None, 300)               0         
                                                                 
 hiddenlayer3 (Dense)        (None, 100)               30100     
                                                                 
 leaky_re_lu_1 (LeakyReLU)   (None, 100)               0         
                                                                 
 outputlayer (Dense)         (None, 2)                 202       
                                                                 
=================================================================
Total params: 265,802
Trainable params: 202
Non-trainable params: 265,600
_________________________________________________________________

[2022-05-19 17:58:41,881: INFO: common]: created directory at: artifacts\models
[2022-05-19 17:58:41,912: INFO: 02_transfer_learning_even_odd]: base model is saved at artifacts\models\even_odd_model.h5
[2022-05-19 17:58:43,656: ERROR: 02_transfer_learning_even_odd]: Graph execution error:

Detected at node 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits' defined at (most recent call last):
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
      main(config_path=parsed_args.config)
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
      logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test_bin)}")
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1716, in evaluate
      tmp_logs = self.test_function(iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1525, in test_function
      return step_function(self, iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1514, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1507, in run_step
      outputs = model.test_step(data)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1473, in test_step
      self.compute_loss(x, y, y_pred, sample_weight)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 918, in compute_loss
      return self.compiled_loss(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\compile_utils.py", line 201, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 141, in __call__
      losses = call_fn(y_true, y_pred)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 245, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 1862, in sparse_categorical_crossentropy
      return backend.sparse_categorical_crossentropy(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\backend.py", line 5202, in sparse_categorical_crossentropy
      res = tf.nn.sparse_softmax_cross_entropy_with_logits(
Node: 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits'
Received a label value of 9 which is outside the valid range of [0, 2).  Label values: 7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1
	 [[{{node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits}}]] [Op:__inference_test_function_226533]
Traceback (most recent call last):
  File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
    main(config_path=parsed_args.config)
  File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
    logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test_bin)}")
  File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\Admin\anaconda3\lib\site-packages\tensorflow\python\eager\execute.py", line 54, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits' defined at (most recent call last):
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 115, in <module>
      main(config_path=parsed_args.config)
    File "C:\Users\Admin\Desktop\vs_code\transferlearning\src\02_transfer_learning_even_odd.py", line 102, in main
      logging.info(f"evaluation metrics {new_model.evaluate(X_test,y_test_bin)}")
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1716, in evaluate
      tmp_logs = self.test_function(iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1525, in test_function
      return step_function(self, iterator)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1514, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1507, in run_step
      outputs = model.test_step(data)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 1473, in test_step
      self.compute_loss(x, y, y_pred, sample_weight)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\training.py", line 918, in compute_loss
      return self.compiled_loss(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\engine\compile_utils.py", line 201, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 141, in __call__
      losses = call_fn(y_true, y_pred)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 245, in call
      return ag_fn(y_true, y_pred, **self._fn_kwargs)
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\losses.py", line 1862, in sparse_categorical_crossentropy
      return backend.sparse_categorical_crossentropy(
    File "C:\Users\Admin\anaconda3\lib\site-packages\keras\backend.py", line 5202, in sparse_categorical_crossentropy
      res = tf.nn.sparse_softmax_cross_entropy_with_logits(
Node: 'sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits'
Received a label value of 9 which is outside the valid range of [0, 2).  Label values: 7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1
	 [[{{node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits}}]] [Op:__inference_test_function_226533]
